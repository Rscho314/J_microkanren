ES =: '';~0
pull =: ]`($:@".@(0&{::))@.procu
take_all =: (({.@:pull),($:@}.@:pull))`]@.(''&-:)
take =: (''"_)`]`({.@pull@],<:@[$:}.@pull@])@.(1 i.~,@((0&=@[)`((''&-:)@])`:0))